import{_ as F,o as w,c as x,a as t,n as _,F as N,r as L,t as f,b as B,d as lt,e as q,f as O,g as j,h as xt,i as yt,j as Et,k as v,w as Q,l as Y,v as tt,m as I,p as D,q as Pt,s as S}from"./index-yI0YaXvt.js";import{d as kt,c as At,l as Tt,s as Mt,z as Ct,F as Dt,a as St,E as Ut,r as Nt}from"./zh_TW--2zbErwe.js";const Lt={data(){return{}},props:["paginationObj"],watch:{paginationObj(){}},methods:{changePage(i){if(i.target.textContent==="Next")this.$emit("emit-selectPage",this.paginationObj.current_page+1);else if(i.target.textContent==="Previous")this.$emit("emit-selectPage",this.paginationObj.current_page-1);else{if(i.target.closest("li").className.includes("active"))return;this.$emit("emit-selectPage",i.target.textContent)}}},created(){},mounted(){}},Ot={class:"pagination justify-content-center"};function Vt(i,e,o,c,s,n){return w(),x("nav",null,[t("ul",Ot,[t("li",{class:_(["page-item",{disabled:!o.paginationObj.has_pre}])},[t("a",{class:_(["page-link",{"text-dark":!o.paginationObj.has_pre}]),onClick:e[0]||(e[0]=(...m)=>n.changePage&&n.changePage(...m))},"Previous",2)],2),(w(!0),x(N,null,L(o.paginationObj.total_pages,(m,r)=>(w(),x("li",{class:_(["page-item",{active:o.paginationObj.current_page===r+1}]),key:"key"+r},[t("a",{class:_(["page-link",{"text-dark":o.paginationObj.current_page===r+1}]),onClick:e[1]||(e[1]=(...p)=>n.changePage&&n.changePage(...p))},f(r+1),3)],2))),128)),t("li",{class:_(["page-item",{disabled:!o.paginationObj.has_next}])},[t("a",{class:_(["page-link",{"text-dark":!o.paginationObj.has_next}]),onClick:e[2]||(e[2]=(...m)=>n.changePage&&n.changePage(...m))},"Next",2)],2)])])}const $t=F(Lt,[["render",Vt]]);var nt={exports:{}},R={exports:{}};/*!
  * Bootstrap backdrop.js v5.3.2 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var et;function It(){return et||(et=1,function(i,e){(function(o,c){i.exports=c(B(),lt(),q())})(O,function(o,c,s){const n="backdrop",m="fade",r="show",p=`mousedown.bs.${n}`,u={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},l={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class g extends c{constructor(d){super(),this._config=this._getConfig(d),this._isAppended=!1,this._element=null}static get Default(){return u}static get DefaultType(){return l}static get NAME(){return n}show(d){if(!this._config.isVisible){s.execute(d);return}this._append();const E=this._getElement();this._config.isAnimated&&s.reflow(E),E.classList.add(r),this._emulateAnimation(()=>{s.execute(d)})}hide(d){if(!this._config.isVisible){s.execute(d);return}this._getElement().classList.remove(r),this._emulateAnimation(()=>{this.dispose(),s.execute(d)})}dispose(){this._isAppended&&(o.off(this._element,p),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const d=document.createElement("div");d.className=this._config.className,this._config.isAnimated&&d.classList.add(m),this._element=d}return this._element}_configAfterMerge(d){return d.rootElement=s.getElement(d.rootElement),d}_append(){if(this._isAppended)return;const d=this._getElement();this._config.rootElement.append(d),o.on(d,p,()=>{s.execute(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(d){s.executeAfterTransition(d,this._getElement(),this._config.isAnimated)}}return g})}(R)),R.exports}var V={exports:{}};/*!
  * Bootstrap component-functions.js v5.3.2 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var st;function Ft(){return st||(st=1,function(i,e){(function(o,c){c(e,B(),j(),q())})(O,function(o,c,s,n){const m=(r,p="hide")=>{const u=`click.dismiss${r.EVENT_KEY}`,l=r.NAME;c.on(document,u,`[data-bs-dismiss="${l}"]`,function(g){if(["A","AREA"].includes(this.tagName)&&g.preventDefault(),n.isDisabled(this))return;const a=s.getElementFromSelector(this)||this.closest(`.${l}`);r.getOrCreateInstance(a)[p]()})};o.enableDismissTrigger=m,Object.defineProperty(o,Symbol.toStringTag,{value:"Module"})})}(V,V.exports)),V.exports}var K={exports:{}};/*!
  * Bootstrap focustrap.js v5.3.2 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var it;function Bt(){return it||(it=1,function(i,e){(function(o,c){i.exports=c(B(),j(),lt())})(O,function(o,c,s){const n="focustrap",r=".bs.focustrap",p=`focusin${r}`,u=`keydown.tab${r}`,l="Tab",g="forward",a="backward",d={autofocus:!0,trapElement:null},E={autofocus:"boolean",trapElement:"element"};class k extends s{constructor(y){super(),this._config=this._getConfig(y),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return d}static get DefaultType(){return E}static get NAME(){return n}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),o.off(document,r),o.on(document,p,y=>this._handleFocusin(y)),o.on(document,u,y=>this._handleKeydown(y)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,o.off(document,r))}_handleFocusin(y){const{trapElement:T}=this._config;if(y.target===document||y.target===T||T.contains(y.target))return;const C=c.focusableChildren(T);C.length===0?T.focus():this._lastTabNavDirection===a?C[C.length-1].focus():C[0].focus()}_handleKeydown(y){y.key===l&&(this._lastTabNavDirection=y.shiftKey?a:g)}}return k})}(K)),K.exports}var z={exports:{}};/*!
  * Bootstrap scrollbar.js v5.3.2 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var ot;function qt(){return ot||(ot=1,function(i,e){(function(o,c){i.exports=c(xt(),j(),q())})(O,function(o,c,s){const n=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",m=".sticky-top",r="padding-right",p="margin-right";class u{constructor(){this._element=document.body}getWidth(){const g=document.documentElement.clientWidth;return Math.abs(window.innerWidth-g)}hide(){const g=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,r,a=>a+g),this._setElementAttributes(n,r,a=>a+g),this._setElementAttributes(m,p,a=>a-g)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,r),this._resetElementAttributes(n,r),this._resetElementAttributes(m,p)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(g,a,d){const E=this.getWidth(),k=A=>{if(A!==this._element&&window.innerWidth>A.clientWidth+E)return;this._saveInitialAttribute(A,a);const y=window.getComputedStyle(A).getPropertyValue(a);A.style.setProperty(a,`${d(Number.parseFloat(y))}px`)};this._applyManipulationCallback(g,k)}_saveInitialAttribute(g,a){const d=g.style.getPropertyValue(a);d&&o.setDataAttribute(g,a,d)}_resetElementAttributes(g,a){const d=E=>{const k=o.getDataAttribute(E,a);if(k===null){E.style.removeProperty(a);return}o.removeDataAttribute(E,a),E.style.setProperty(a,k)};this._applyManipulationCallback(g,d)}_applyManipulationCallback(g,a){if(s.isElement(g)){a(g);return}for(const d of c.find(g,this._element))a(d)}}return u})}(z)),z.exports}/*!
  * Bootstrap modal.js v5.3.2 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */(function(i,e){(function(o,c){i.exports=c(yt(),B(),j(),It(),Ft(),Bt(),q(),qt())})(O,function(o,c,s,n,m,r,p,u){const l="modal",a=".bs.modal",d=".data-api",E="Escape",k=`hide${a}`,A=`hidePrevented${a}`,y=`hidden${a}`,T=`show${a}`,C=`shown${a}`,ct=`resize${a}`,rt=`click.dismiss${a}`,dt=`mousedown.dismiss${a}`,mt=`keydown.dismiss${a}`,ut=`click${a}${d}`,J="modal-open",ht="fade",X="show",W="modal-static",gt=".modal.show",_t=".modal-dialog",pt=".modal-body",ft='[data-bs-toggle="modal"]',bt={backdrop:!0,focus:!0,keyboard:!0},vt={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class M extends o{constructor(h,b){super(h,b),this._dialog=s.findOne(_t,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new u,this._addEventListeners()}static get Default(){return bt}static get DefaultType(){return vt}static get NAME(){return l}toggle(h){return this._isShown?this.hide():this.show(h)}show(h){this._isShown||this._isTransitioning||c.trigger(this._element,T,{relatedTarget:h}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(J),this._adjustDialog(),this._backdrop.show(()=>this._showElement(h)))}hide(){!this._isShown||this._isTransitioning||c.trigger(this._element,k).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(X),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){c.off(window,a),c.off(this._dialog,a),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new n({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new r({trapElement:this._element})}_showElement(h){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const b=s.findOne(pt,this._dialog);b&&(b.scrollTop=0),p.reflow(this._element),this._element.classList.add(X);const P=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,c.trigger(this._element,C,{relatedTarget:h})};this._queueCallback(P,this._dialog,this._isAnimated())}_addEventListeners(){c.on(this._element,mt,h=>{if(h.key===E){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),c.on(window,ct,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),c.on(this._element,dt,h=>{c.one(this._element,rt,b=>{if(!(this._element!==h.target||this._element!==b.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(J),this._resetAdjustments(),this._scrollBar.reset(),c.trigger(this._element,y)})}_isAnimated(){return this._element.classList.contains(ht)}_triggerBackdropTransition(){if(c.trigger(this._element,A).defaultPrevented)return;const b=this._element.scrollHeight>document.documentElement.clientHeight,P=this._element.style.overflowY;P==="hidden"||this._element.classList.contains(W)||(b||(this._element.style.overflowY="hidden"),this._element.classList.add(W),this._queueCallback(()=>{this._element.classList.remove(W),this._queueCallback(()=>{this._element.style.overflowY=P},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const h=this._element.scrollHeight>document.documentElement.clientHeight,b=this._scrollBar.getWidth(),P=b>0;if(P&&!h){const U=p.isRTL()?"paddingLeft":"paddingRight";this._element.style[U]=`${b}px`}if(!P&&h){const U=p.isRTL()?"paddingRight":"paddingLeft";this._element.style[U]=`${b}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(h,b){return this.each(function(){const P=M.getOrCreateInstance(this,h);if(typeof h=="string"){if(typeof P[h]>"u")throw new TypeError(`No method named "${h}"`);P[h](b)}})}}return c.on(document,ut,ft,function(wt){const h=s.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&wt.preventDefault(),c.one(h,T,U=>{U.defaultPrevented||c.one(h,y,()=>{p.isVisible(this)&&this.focus()})});const b=s.findOne(gt);b&&M.getInstance(b).hide(),M.getOrCreateInstance(h).toggle(this)}),m.enableDismissTrigger(M),p.defineJQueryPlugin(M),M})})(nt);var jt=nt.exports;const Wt=Et(jt),at={methods:{showModal(){const i=new Wt(this.$refs.modal,{keyboard:!1});this.modal=i,this.modal.show()},hideModal(){this.tempProduct={},this.imageUrl="",this.disabled=!1,this.fileData="",this.$emit("emit-hideModal"),this.modal.hide()}}},G="https://ec-course-api.hexschool.io/",H="bftsai";kt("required",Nt);At({validateOnInput:!0,generateMessage:Tt({zh_TW:Ct})});Mt("zh_TW");const Yt={data(){return{tempProduct:{},imageUrl:"",disabled:!1,fileData:""}},mixins:[at],props:{productModal:{typeof:Object,default(){return{}}}},components:{VForm:Dt,VField:St,ErrorMessage:Ut},watch:{imageUrl(){this.imageUrl?this.disabled=!0:this.disabled=!1},productModal(){this.tempProduct={...this.productModal}}},methods:{throttle(i){let e,o;return(...c)=>{o=c,!e&&(i(o),o=null,e=setTimeout(()=>{e=null,o&&(i(o),o=null)},1e3))}},onSubmit(){this.tempProduct.imageUrl&&(this.disabled?this.tempProduct.is_enabled=0:this.tempProduct.is_enabled=1,this.tempProduct.id?this.putProduct({data:this.tempProduct}):this.postProduct({data:this.tempProduct}))},async postProduct(i){try{this.$emit("emit-toggleLoading");const e=(await this.axios.post(`${G}v2/api/${H}/admin/product`,i)).data;if(this.$emit("emit-toggleLoading"),e.success){const o={icon:"success",title:e.message,timer:1500};this.$swal(o),this.hideModal(),this.$emit("emit-getProducts")}else{const o={icon:"error",title:e.message};this.$swal(o)}}catch(e){console.log(e.response)}},async putProduct(i){try{this.$emit("emit-toggleLoading");const e=(await this.axios.put(`${G}/v2/api/${H}/admin/product/${this.tempProduct.id}`,i)).data;if(this.$emit("emit-toggleLoading"),e.success){const o={icon:"success",title:e.message,timer:1500};this.$swal(o),this.hideModal(),this.tempProduct={},this.$emit("emit-getProducts")}else{const o={icon:"error",title:e.message};this.$swal(o)}}catch(e){console.log(e)}},async loadFile(i){try{const e=i.target.files[0],o=new FormData;o.append("file-to-upload",e);const c=await this.axios.post(`${G}/v2/api/${H}/admin/upload`,o);this.imageUrl=c.data.imageUrl}catch(e){console.log(e.response)}},deleteImageUrl(){this.imageUrl="",this.fileData=""},deleteTempImage(i){if(i.target.previousElementSibling.alt.includes("imageUrl"))this.tempProduct.imageUrl="";else{const e=Number(i.target.previousElementSibling.alt.split("imagesUrl")[1]);this.tempProduct.imagesUrl.splice(e,1)}},addProductImage(){this.imageUrl&&(this.tempProduct.imageUrl?this.tempProduct.imagesUrl.push(this.imageUrl):this.tempProduct.imageUrl=this.imageUrl,this.imageUrl="")}},mounted(){}},Rt={class:"modal fade",id:"exampleModal","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},Kt={class:"modal-dialog modal-xl"},zt={class:"modal-header"},Gt=t("h5",{class:"modal-title fs-5",id:"exampleModalLabel"},"Edit Product",-1),Ht={class:"modal-body"},Zt={class:"row"},Jt={class:"col-4"},Xt={class:"row"},Qt={class:"col-12 mb-3 d-flex flex-column"},te=t("span",{class:"invalid-feedback",name:"imageUrl"},"請輸入主圖照片",-1),ee=["disabled"],se={key:0,class:"col-12 mb-3 position-relative"},ie=["src"],oe=t("span",{class:"visually-hidden"},"unread messages",-1),le={class:"row"},ne={key:0,class:"col-6 position-relative mb-3"},ae=["src"],ce=t("span",{class:"visually-hidden"},"unread messages",-1),re=["src","alt"],de=t("span",{class:"visually-hidden"},"unread messages",-1),me={class:"col-8"},ue={class:"mb-3 d-flex align-items-center"},he=t("label",{for:"title",class:"form-label"},"Title：",-1),ge={class:"w-100 d-flex flex-column"},_e={class:"row"},pe={class:"col-6"},fe={class:"mb-3 d-flex align-items-center"},be=t("label",{for:"category",class:"form-label"},"Category：",-1),ve={class:"w-100 d-flex flex-column"},we={class:"col-6"},xe={class:"mb-3 d-flex align-items-center"},ye=t("label",{for:"unit",class:"form-label"},"Unit：",-1),Ee={class:"w-100 d-flex flex-column"},Pe={class:"row"},ke={class:"col-6"},Ae={class:"mb-3 d-flex align-items-center"},Te=t("label",{for:"origin_price",class:"form-label"},"Origin_price：",-1),Me={class:"w-100 d-flex flex-column"},Ce={class:"col-6"},De={class:"mb-3 d-flex align-items-center"},Se=t("label",{for:"price",class:"form-label"},"Price：",-1),Ue={class:"w-100 d-flex flex-column"},Ne={class:"mb-3 d-flex align-items-center"},Le=t("label",{for:"content",class:"form-label"},"Content：",-1),Oe={class:"w-100 d-flex flex-column"},Ve={class:"mb-3"},$e=t("label",{for:"description",class:"form-label"},"Description：",-1),Ie={class:"w-100"},Fe={class:"mb-3 d-flex align-items-center"},Be=["checked"],qe=t("label",{for:"is_enabled",class:"form-check-label"},"啟用",-1),je={class:"modal-footer"},We=t("button",{type:"submit",class:"btn btn-primary"},"Save changes",-1);function Ye(i,e,o,c,s,n){const m=S("v-field"),r=S("error-message"),p=S("v-form");return w(),x("div",Rt,[t("div",Kt,[v(p,{class:"modal-content",onSubmit:n.onSubmit},{default:Q(({errors:u})=>[t("div",zt,[Gt,t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:e[0]||(e[0]=(...l)=>i.hideModal&&i.hideModal(...l))})]),t("div",Ht,[t("div",Zt,[t("div",Jt,[t("div",Xt,[t("div",Qt,[s.imageUrl?I("",!0):Y((w(),x("input",{key:0,type:"text",placeholder:"請輸入圖片網址",name:"imageUrl",class:_(["form-control",{"is-invalid":!s.tempProduct.imageUrl}]),"onUpdate:modelValue":e[1]||(e[1]=l=>s.imageUrl=l)},null,2)),[[tt,s.imageUrl]]),te,t("input",{type:"file",disabled:s.disabled,onChange:e[2]||(e[2]=(...l)=>n.loadFile&&n.loadFile(...l))},null,40,ee),t("button",{type:"button",class:"btn btn-primary me-3",onClick:e[3]||(e[3]=(...l)=>n.addProductImage&&n.addProductImage(...l))},"新增")]),s.imageUrl?(w(),x("div",se,[t("img",{src:s.imageUrl,alt:"edit product pic",class:"object-fit-cover w-100"},null,8,ie),t("span",{class:"position-absolute top-0 start-75 translate-middle badge rounded-circle bg-danger me-3",onClick:e[4]||(e[4]=(...l)=>n.deleteImageUrl&&n.deleteImageUrl(...l))},[D(" - "),oe])])):I("",!0)]),t("div",le,[s.tempProduct.imageUrl?(w(),x("div",ne,[t("img",{src:s.tempProduct.imageUrl,alt:"'imageUrl'",class:"object-fit-cover w-100"},null,8,ae),t("span",{class:"position-absolute top-0 start-75 translate-middle badge rounded-circle bg-danger me-3",onClick:e[5]||(e[5]=(...l)=>n.deleteTempImage&&n.deleteTempImage(...l))},[D(" - "),ce])])):I("",!0),(w(!0),x(N,null,L(s.tempProduct.imagesUrl,(l,g)=>(w(),x("div",{class:"col-6 position-relative mb-3",key:"key"+g},[t("img",{src:l,alt:"imagesUrl"+g,class:"object-fit-cover w-100"},null,8,re),t("span",{class:"position-absolute top-0 start-75 translate-middle badge rounded-circle bg-danger me-3",onClick:e[6]||(e[6]=(...a)=>n.deleteTempImage&&n.deleteTempImage(...a))},[D(" - "),de])]))),128))])]),t("div",me,[t("div",ue,[he,t("div",ge,[v(m,{type:"text",id:"title",class:_(["form-control",{"is-invalid":u.Title}]),name:"Title",modelValue:s.tempProduct.title,"onUpdate:modelValue":e[7]||(e[7]=l=>s.tempProduct.title=l),rules:"required"},null,8,["class","modelValue"]),v(r,{class:"invalid-feedback",name:"Title"})])]),t("div",_e,[t("div",pe,[t("div",fe,[be,t("div",ve,[v(m,{type:"text",id:"category",class:_(["form-control",{"is-invalid":u.Category}]),name:"Category",modelValue:s.tempProduct.category,"onUpdate:modelValue":e[8]||(e[8]=l=>s.tempProduct.category=l),rules:"required"},null,8,["class","modelValue"]),v(r,{class:"invalid-feedback",name:"Category"})])])]),t("div",we,[t("div",xe,[ye,t("div",Ee,[v(m,{type:"text",id:"unit",class:_(["form-control",{"is-invalid":u.Unit}]),name:"Unit",modelValue:s.tempProduct.unit,"onUpdate:modelValue":e[9]||(e[9]=l=>s.tempProduct.unit=l),rules:"required"},null,8,["class","modelValue"]),v(r,{class:"invalid-feedback",name:"Unit"})])])])]),t("div",Pe,[t("div",ke,[t("div",Ae,[Te,t("div",Me,[v(m,{type:"number",id:"origin_price",class:_(["form-control",{"is-invalid":u.Origin_price}]),name:"Origin_price",modelValue:s.tempProduct.origin_price,"onUpdate:modelValue":e[10]||(e[10]=l=>s.tempProduct.origin_price=l),rules:"required"},null,8,["class","modelValue"]),v(r,{class:"invalid-feedback",name:"Origin_price"})])])]),t("div",Ce,[t("div",De,[Se,t("div",Ue,[v(m,{type:"number",id:"price",class:_(["form-control",{"is-invalid":u.Price}]),name:"Price",modelValue:s.tempProduct.price,"onUpdate:modelValue":e[11]||(e[11]=l=>s.tempProduct.price=l),rules:"required"},null,8,["class","modelValue"]),v(r,{class:"invalid-feedback",name:"Price"})])])])]),t("div",Ne,[Le,t("div",Oe,[v(m,{type:"text",id:"content",class:_(["form-control",{"is-invalid":u.Content}]),name:"Content",modelValue:s.tempProduct.content,"onUpdate:modelValue":e[12]||(e[12]=l=>s.tempProduct.content=l),rules:"required"},null,8,["class","modelValue"]),v(r,{class:"invalid-feedback",name:"Content"})])]),t("div",Ve,[$e,t("div",Ie,[v(m,{name:"Description",rules:"required",modelValue:s.tempProduct.description,"onUpdate:modelValue":e[14]||(e[14]=l=>s.tempProduct.description=l)},{default:Q(()=>[Y(t("textarea",{name:"Description",class:_(["w-100",{"is-invalid":u.Description}]),id:"description",cols:"30",rows:"3",placeholder:"請輸入產品描述","onUpdate:modelValue":e[13]||(e[13]=l=>s.tempProduct.description=l)},null,2),[[tt,s.tempProduct.description]]),v(r,{name:"Description",class:"invalid-feedback"})]),_:2},1032,["modelValue"])])]),t("div",Fe,[Y(t("input",{type:"checkbox",id:"is_enabled",class:"form-check-input me-2",checked:s.tempProduct.is_enabled,"onUpdate:modelValue":e[15]||(e[15]=l=>s.tempProduct.is_enabled=l)},null,8,Be),[[Pt,s.tempProduct.is_enabled]]),qe])])])]),t("div",je,[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",onClick:e[16]||(e[16]=(...l)=>i.hideModal&&i.hideModal(...l))},"Close"),We])]),_:1},8,["onSubmit"])])],512)}const Re=F(Yt,[["render",Ye]]),Ke="https://ec-course-api.hexschool.io/",ze="bftsai",Ge={data(){return{tempProduct:{}}},props:{deleteModal:{typeof:Object,default(){return{}}}},mixins:[at],watch:{deleteModal(){this.tempProduct={...this.deleteModal}}},methods:{async deleteProduct(){try{const i=this.tempProduct.id;this.$emit("emit-toggleLoading");const e=(await this.axios.delete(`${Ke}/v2/api/${ze}/admin/product/${i}`)).data;if(this.$emit("emit-toggleLoading"),e.success){const o={icon:"success",title:e.message,timer:1500};this.$swal(o),this.hideModal(),this.tempProduct={},this.$emit("emit-getProducts")}else{const o={icon:"error",title:e.message};this.$swal(o)}}catch(i){console.log(i)}}},mounted(){}},He={class:"modal fade",id:"exampleModal","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},Ze={class:"modal-dialog modal-xl"},Je={class:"modal-content"},Xe={class:"modal-header"},Qe=t("h5",{class:"modal-title fs-5",id:"exampleModalLabel"},"Delete Product",-1),ts={class:"modal-body"},es={class:"row"},ss={class:"col-4"},is={class:"row"},os={class:"col-12 mb-3 d-flex flex-wrap justify-content-between"},ls=["src"],ns=["src"],as={class:"col-8"},cs={class:"mb-3 d-flex align-items-center"},rs={class:"row"},ds={class:"col-6"},ms={class:"mb-3 d-flex align-items-center"},us={class:"col-6"},hs={class:"mb-3 d-flex align-items-center"},gs={class:"row"},_s={class:"col-6"},ps={class:"mb-3 d-flex align-items-center"},fs={class:"col-6"},bs={class:"mb-3 d-flex align-items-center"},vs={class:"mb-3 d-flex align-items-center"},ws={class:"mb-3"},xs={class:"w-100"},ys={class:"mb-3 d-flex align-items-center"},Es={class:"modal-footer"};function Ps(i,e,o,c,s,n){return w(),x("div",He,[t("div",Ze,[t("div",Je,[t("div",Xe,[Qe,t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:e[0]||(e[0]=(...m)=>i.hideModal&&i.hideModal(...m))})]),t("div",ts,[t("div",es,[t("div",ss,[t("div",is,[t("div",os,[t("img",{class:"object-fit-cover w-50 mb-3",src:s.tempProduct.imageUrl,alt:"imageUrl"},null,8,ls),(w(!0),x(N,null,L(s.tempProduct.imagesUrl,(m,r)=>(w(),x("img",{class:"object-fit-cover w-50 mb-3",src:m,alt:"'imagesUrl' + key",key:"imagesUrl"+r},null,8,ns))),128))])])]),t("div",as,[t("div",cs,[t("p",null,"Title："+f(s.tempProduct.title),1)]),t("div",rs,[t("div",ds,[t("div",ms,[t("p",null,"Category："+f(s.tempProduct.category),1)])]),t("div",us,[t("div",hs,[t("p",null,"Unit："+f(s.tempProduct.unit),1)])])]),t("div",gs,[t("div",_s,[t("div",ps,[t("p",null,"origin_price："+f(s.tempProduct.origin_price),1)])]),t("div",fs,[t("div",bs,[t("p",null,"Price："+f(s.tempProduct.price),1)])])]),t("div",vs,[t("p",null,"Content："+f(s.tempProduct.content),1)]),t("div",ws,[t("div",xs,[t("p",null,"Description："+f(s.tempProduct.description),1)])]),t("div",ys,[t("p",{class:_(["text-success",{"text-danger":!s.tempProduct.is_enabled}])},f(s.tempProduct.is_enabled?"啟用":"未啟用"),3)])])])]),t("div",Es,[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",onClick:e[1]||(e[1]=(...m)=>i.hideModal&&i.hideModal(...m))},"Close"),t("button",{type:"submit",class:"btn btn-outline-danger",onClick:e[2]||(e[2]=(...m)=>n.deleteProduct&&n.deleteProduct(...m))},"Delete Product")])])])],512)}const ks=F(Ge,[["render",Ps]]),$="https://ec-course-api.hexschool.io/",Z="bftsai",As={data(){return{products:[],paginationObj:{},itemSelect:{},productsNum:0}},components:{pagination:$t,productModal:Re,deleteModal:ks},props:["defaultTheme"],watch:{defaultTheme(){}},methods:{textDanger(i){if(!i&&this.defaultTheme==="light")return!0},textLight(i){if(!i&&this.defaultTheme==="dark")return!0},async getAllProducts(){try{const i=(await this.axios.get(`${$}v2/api/${Z}/admin/products/all`)).data.products;this.productsNum=Object.keys(i)}catch(i){console.log(i.response.data)}},async getProducts(i=1){try{this.itemSelect={},this.product=[],this.$emit("emit-toggleLoading");const e=(await this.axios.get(`${$}v2/api/${Z}/admin/products?page=${i}`)).data;this.products=e.products,this.paginationObj=e.pagination,this.$emit("emit-toggleLoading");const o={icon:"success",title:"已取得產品資料",timer:1500};this.$swal(o)}catch(e){console.log(e),this.$emit("emit-toggleLoading");const o={icon:"error",title:e.response.data.message};this.$swal(o)}},checkProduct(i){this.itemSelect=JSON.parse(JSON.stringify(i))},async postProduct(){try{const i={data:{title:"香蕉派",category:"蛋糕",origin_price:200,price:150,unit:"個",description:"呈現經典的美味及口感。",content:"尺寸：8寸",is_enabled:7,imageUrl:"https://images.unsplash.com/photo-1484723091739-30a097e8f929?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8M3x8YmFuYW5hJTIwcGllfGVufDB8fDB8fHww",imagesUrl:["https://images.unsplash.com/photo-1616953343564-dcf52de3262c?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTB8fGJhbmFuYSUyMHBpZXxlbnwwfHwwfHx8MA%3D%3D","https://images.unsplash.com/photo-1517777596324-5df4025800f2?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTJ8fGJhbmFuYSUyMHBpZXxlbnwwfHwwfHx8MA%3D%3D","https://images.unsplash.com/photo-1636819232432-77f353ba39f8?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTZ8fGJhbmFuYSUyMHBpZXxlbnwwfHwwfHx8MA%3D%3D"]}},e=await this.axios.post(`${$}v2/api/${Z}/admin/product`,i);console.log(e)}catch(i){console.log(i)}},async checkLogin(){try{this.$emit("emit-toggleLoading");const i=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*=\s*([^;]*).*$)|^.*$/,"$1");this.axios.defaults.headers.common.Authorization=i;const e=(await this.axios.post(`${$}v2/api/user/check`)).data;e.success&&(this.$emit("emit-toggleLogin",e.success),this.getProducts(1)),this.$emit("emit-toggleLoading")}catch(i){this.$emit("emit-toggleLogin",i.response.data.success);const e={icon:"error",title:i.response.data.message,timer:1500};this.$swal(e),this.$emit("emit-toggleLoading"),i.response.data.success||this.$router.push("login")}},selectPage(i){this.getProducts(i)},productModal(i){i.id?this.itemSelect={...i}:this.itemSelect={imagesUrl:[]},this.$refs.productModal.showModal()},deleteProduct(i){this.itemSelect={...i},this.$refs.deleteModal.showModal()},hideModal(){this.itemSelect={}},toggleLoading(){this.$emit("emit-toggleLoading")}},mounted(){this.$emit("emit-login"),this.checkLogin(),this.getAllProducts()}},Ts={class:"container"},Ms={class:"row"},Cs={class:"col-lg-8"},Ds=t("h1",null,"Products List",-1),Ss={class:"table table-hover"},Us=t("thead",null,[t("tr",{class:"text-center"},[t("th",{class:"w-50",scope:"col"},"產品名稱"),t("th",{scope:"col"},"原價"),t("th",{scope:"col"},"售價"),t("th",{scope:"col"},"是否啟用"),t("th",{scope:"col"},"查看細節"),t("th",{scope:"col"},"編輯")])],-1),Ns={class:"w-50 text-start"},Ls=["onClick"],Os={colspan:"2"},Vs=["onClick"],$s=["onClick"],Is={key:0,class:"col-lg-4"},Fs=t("h2",null,"Product",-1),Bs=["src","alt"],qs={class:"card-body"},js={class:"card-title"},Ws={class:"card-text"},Ys={class:"card-text"},Rs={class:"card-text"},Ks={class:"d-flex flex-wrap mb-3"},zs=["src","alt"];function Gs(i,e,o,c,s,n){const m=S("productModal"),r=S("deleteModal"),p=S("pagination");return w(),x("div",Ts,[t("div",Ms,[t("div",Cs,[v(m,{ref:"productModal","product-modal":s.itemSelect,"emit-hide-modal":n.hideModal,onEmitGetProducts:n.getProducts,onEmitToggleLoading:n.toggleLoading},null,8,["product-modal","emit-hide-modal","onEmitGetProducts","onEmitToggleLoading"]),v(r,{ref:"deleteModal","delete-modal":s.itemSelect,onEmitHideModal:n.hideModal,onEmitGetProducts:n.getProducts,onEmitToggleLoading:n.toggleLoading},null,8,["delete-modal","onEmitHideModal","onEmitGetProducts","onEmitToggleLoading"]),Ds,t("button",{class:_(["btn d-block ms-auto",{"btn-secondary":o.defaultTheme==="light","btn-outline-primary":o.defaultTheme==="dark"}]),onClick:e[0]||(e[0]=(...u)=>n.productModal&&n.productModal(...u))},"建立新產品",2),t("table",Ss,[Us,t("tbody",null,[(w(!0),x(N,null,L(s.products,u=>(w(),x("tr",{key:u.title,class:"text-center"},[t("td",Ns,f(u.title),1),t("td",null,f(u.origin_price),1),t("td",null,f(u.price),1),t("td",{class:_({"text-danger":n.textDanger(u.is_enabled),"text-light":n.textLight(u.is_enabled)})},f(u.is_enabled?"啟用":"未啟用"),3),t("td",null,[t("button",{type:"button",class:_(["btn w-100 p-1",{"btn-secondary":o.defaultTheme==="light","btn-outline-primary":o.defaultTheme==="dark"}]),onClick:l=>n.checkProduct(u)},"查看細節",10,Ls)]),t("td",Os,[t("button",{type:"button",class:_(["btn p-1 me-3",{"btn-secondary":o.defaultTheme==="light","btn-outline-primary":o.defaultTheme==="dark"}]),onClick:l=>n.productModal(u)},"編輯",10,Vs),t("button",{type:"button",class:_(["btn p-1 btn-outline-danger",{"text-primary":o.defaultTheme==="dark"}]),onClick:l=>n.deleteProduct(u)},"刪除",10,$s)])]))),128))])]),v(p,{"pagination-obj":s.paginationObj,onEmitSelectPage:n.selectPage},null,8,["pagination-obj","onEmitSelectPage"])]),s.itemSelect.id?(w(),x("div",Is,[Fs,t("div",{class:_(["card mb-3",{"border-primary":o.defaultTheme==="dark"}])},[t("img",{src:s.itemSelect.imageUrl,class:"card-img-top object-fit-contain",alt:s.itemSelect.title,height:"400"},null,8,Bs),t("div",qs,[t("h5",js,[D(f(s.itemSelect.title),1),t("span",{class:_(["badge ms-3",{" text-bg-secondary":o.defaultTheme==="light"," text-bg-primary":o.defaultTheme==="dark"}])},f(s.itemSelect.category),3)]),t("p",Ws,"商品內容："+f(s.itemSelect.content),1),t("p",Ys,"商品描述："+f(s.itemSelect.description),1),t("p",Rs,[D(f(s.itemSelect.price)+" ",1),t("span",{class:_(["line-through",{"text-light":o.defaultTheme==="dark"}])},f(s.itemSelect.origin_price),3),D("元 / 個")])])],2),t("div",Ks,[(w(!0),x(N,null,L(s.itemSelect.imagesUrl,(u,l)=>(w(),x("img",{src:u,alt:"小圖"+l,key:"小圖"+l,height:"200",class:"me-3 mb-3"},null,8,zs))),128))])])):I("",!0)])])}const Js=F(As,[["render",Gs]]);export{Js as default};
